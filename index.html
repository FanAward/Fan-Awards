<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fan Award</title>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<style>
    :root {
        --primary-gold: #d4af37;
        --bg-dark: #0f0f0f;
        --panel-gray: #222222; 
        --card-bg: rgba(255, 255, 255, 0.05);
        --status-stop: #e67e22;
        --status-start: #27ae60;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: radial-gradient(circle at top, #1a1a1a 0%, #000 100%);
        color: #fff;
        margin: 0;
        padding: 15px;
        min-height: 100vh;
    }

    .container { max-width: 800px; margin: auto; }

    .categories-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .category-card:last-child:nth-child(odd) { grid-column: span 2; width: 60%; justify-self: center; }

    .category-card {
        background: var(--card-bg);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 15px;
        padding: 10px;
        cursor: pointer;
        text-align: center;
    }
    .category-card img { width: 100%; height: 140px; object-fit: cover; border-radius: 10px; }

    .voting-area {
        display: none;
        background-color: var(--panel-gray);
        border: 2px solid #333;
        border-radius: 25px;
        padding: 25px;
        margin-top: 20px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.6);
    }

    .candidates-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px; }

    .candidate { 
        background: rgba(255, 255, 255, 0.05);
        padding: 15px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1);
        text-align: center;
    }

    .candidate img { width: 85px; height: 85px; border-radius: 50%; border: 2px solid var(--primary-gold); object-fit: cover; margin-bottom: 10px; }

    #progress-container { width: 100%; background: #333; border-radius: 10px; margin: 20px 0; height: 8px; }
    #progress-bar { width: 0%; height: 100%; background: var(--primary-gold); transition: width 0.5s ease; }

    button { background: var(--primary-gold); color: #000; border: none; padding: 10px; border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s; }
    button:disabled { background: #555 !important; cursor: not-allowed; opacity: 0.6; }
    
    .back-btn { background: #444; color: #fff; width: auto; padding: 8px 15px; margin-bottom: 15px; }
    
    .results-panel {
        display: none;
        background: #111;
        border: 1px solid var(--primary-gold);
        border-radius: 20px;
        padding: 25px;
        margin-top: 30px;
    }
    .category-result { border-bottom: 1px solid #333; padding: 15px 0; }
    .candidate-score { display: flex; justify-content: space-between; background: rgba(255,255,255,0.03); margin: 5px 0; padding: 8px 15px; border-radius: 5px; font-size: 0.9rem; }
    .winner-tag { color: #0f0; font-weight: bold; margin-top: 10px; display: block; background: rgba(0,255,0,0.1); padding: 5px; border-radius: 5px; text-align: center; }
    
    .admin-controls { display: flex; gap: 10px; flex-direction: column; margin-top: 20px; }
    .reset-danger-btn { background: #900; color: white; border: 1px solid #f00; }
    #toggle-voting-btn.stop { background: var(--status-stop); color: white; }
    #toggle-voting-btn.start { background: var(--status-start); color: white; }

    .modal-overlay {
        display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.85); z-index: 2000; align-items: center; justify-content: center;
    }
    .modal-box {
        background: #222; border: 2px solid var(--primary-gold); padding: 30px;
        border-radius: 20px; width: 90%; max-width: 400px; text-align: center;
    }
    .modal-buttons { display: flex; gap: 10px; margin-top: 20px; }
    .btn-yes { background: #d9534f; color: white; }
    .btn-cancel { background: #5bc0de; color: white; }

    h1 { background: linear-gradient(to bottom, #fff, var(--primary-gold)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; }
</style>
</head>

<body>
<div class="container">
    <h1>Fan Award</h1>
    <p style="text-align: center;">!Welcome to fan award</p>
    <p id="voting-status-msg" style="text-align: center; color: var(--primary-gold); font-weight: bold;"></p>
    
    <div id="progress-container"><div id="progress-bar"></div></div>

    <div id="main-grid" class="categories-grid"></div>

    <div id="voting-area" class="voting-area">
        <button class="back-btn" onclick="showGrid()">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
        <h2 id="current-category-title" style="text-align: center; color: var(--primary-gold);"></h2>
        <div id="candidates-container" class="candidates-grid"></div>
    </div>

    <div style="text-align: center; margin-top: 40px;">
        <button id="admin-access-btn" style="background:none; color:#444; border:1px solid #222; width:auto; font-size: 0.8rem;" onclick="unlockAdmin()">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØµÙˆÙŠØªØ§Øª</button>
    </div>

    <div id="results-panel" class="results-panel">
        <h2 style="text-align: center; color: var(--primary-gold);">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h2>
        <div id="results-content"></div>
        
        <div class="admin-controls">
            <button id="toggle-voting-btn" onclick="toggleVoting()"></button>
            <button class="reset-danger-btn" onclick="openResetModal()">âš ï¸ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§ÙØ© Ø§Ù„ØªØµÙˆÙŠØªØ§Øª</button>
        </div>
    </div>
</div>

<div id="resetModal" class="modal-overlay">
    <div class="modal-box">
        <h3 style="color: #fff;">ØªØ­Ø°ÙŠØ±!</h3>
        <p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§ÙØ© Ø§Ù„ØªØµÙˆÙŠØªØ§ØªØŸ</p>
        <div class="modal-buttons">
            <button class="btn-yes" onclick="confirmReset()">Yes</button>
            <button class="btn-cancel" onclick="closeResetModal()">Cancel</button>
        </div>
    </div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAG2A7nWx-Mnq3aB8182945PAM6iZxRiFk",
  authDomain: "fan-award.firebaseapp.com",
  databaseURL: "https://fan-award-99805-default-rtdb.firebaseio.com/",
  projectId: "fan-award",
  storageBucket: "fan-award.firebasestorage.app",
  messagingSenderId: "575009416899",
  appId: "1:575009416899:web:6fcdd03f30d11896046476",
  measurementId: "G-0LMWPN63X7"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const categoriesData = [
    {
        title: "ÙƒØ¨Ø§Ø± Ø§Ù„ÙØ§Ù†Ø²",
        cover: "https://i.postimg.cc/XvsVJTsb/Picsart-26-01-25-14-07-23-728.png",
        candidates: [
            {name: "Mrs Avocado", img: "https://i.postimg.cc/65BkG7Rc/ghaithxsara-fans-14041106-104153672.jpg"},
            {name: "Abrar", img: "https://i.postimg.cc/dtmJbPRd/aaaxx-1-14041106-104329227.jpg"},
            {name: "Tween", img: "https://i.postimg.cc/GpnJHDTw/tween-b2-14041106-104221136.jpg"},
            {name: "Yana", img: "https://i.postimg.cc/rss5vC3m/lancrv-14041106-104204630.jpg"},
            {name: "Malak", img: "https://i.postimg.cc/YqJQsF32/iconic-malak-14041106-104237528.jpg"},
            {name: "Raghad", img: "https://i.postimg.cc/s2z7VRbQ/raghad-b1-14041106-104249920.jpg"}
        ]
    },
    {
        title: "Ø§Ù„Ù…ØµÙ…Ù… Ø§Ù„Ù…ÙØ¶Ù„",
        cover: "https://i.postimg.cc/pTgyWwdy/Picsart-26-01-25-14-12-22-577.png",
        candidates: [
            {name: "Aziz", img: "https://i.postimg.cc/J0XYfL96/narinvsn-14041106-111648574.jpg"},
            {name: "Fras", img: "https://i.postimg.cc/d1y9194Z/ghaith-fras-14041106-111624327.jpg"},
            {name: "Rami", img: "https://i.postimg.cc/7ZwtWjX7/talin-family3-14041106-111638529.jpg"},
            {name: "Munzar", img: "https://i.postimg.cc/HLSN53wy/fan-fouad-1-14041106-111658002.jpg"},
            {name: "Osama", img: "https://i.postimg.cc/6pbVfPP4/mqnrt-14041106-111611071.jpg"},
            {name: "Mutasem", img: "https://i.postimg.cc/0ykZfD2S/ghaith-ediit-14041106-111631582.jpg"}
        ]
    },
    {
        title: "Ø§Ù„Ù…ØµÙ…Ù…Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø©",
        cover: "https://i.postimg.cc/QN1dgntH/Picsart-26-01-25-14-13-54-206.png",
        candidates: [
            {name: "Hajar", img: "https://i.postimg.cc/C1cwRj1G/janaqueen-hajar-14041106-112411741.jpg"},
            {name: "Reem", img: "https://i.postimg.cc/bvHyhXfm/reem-km3-14041106-112438826.jpg"},
            {name: "Maisam", img: "https://i.postimg.cc/VLpL9BFD/lanax9-14041106-112455102.jpg"},
            {name: "Hala", img: "https://i.postimg.cc/pLKxfNrj/7ala10-1-14041106-112425720.jpg"},
            {name: "Yara", img: "https://i.postimg.cc/d3WDcbrC/IMG-20260125-112541.jpg"},
            {name: "Fatima", img: "https://i.postimg.cc/sXs2QjJp/ghaith-fatima13-14041106-112526414.jpg"}
        ]
    },
    {
        title: "Ø§Ù„ÙØ§Ù†Ø² Ø§Ù„Ù…ÙØ¶Ù„Ø©",
        cover: "https://i.postimg.cc/N0H3hSZ2/Picsart-26-01-25-14-16-39-061.png",
        candidates: [
            {name: "Abrar", img: "https://i.postimg.cc/FKCXVhy2/a9-ux-14041106-113727398.jpg"},
            {name: "Amira", img: "https://i.postimg.cc/c188pHby/nariuiiiiil-14041106-113651707.jpg"},
            {name: "Tebo", img: "https://i.postimg.cc/Qdq7fynX/tebo-ghaith77-14041106-113703589.jpg"},
            {name: "Rayan", img: "https://i.postimg.cc/0jLjNpX9/just-rayan27-14041106-113713738.jpg"},
            {name: "Lina", img: "https://i.postimg.cc/Qd6t9GyB/lina-x-42-14041106-113641698.jpg"},
            {name: "Nour", img: "https://i.postimg.cc/wvrTWXpt/1nxlla-14041106-113737667.jpg"},
            {name: "Malak", img: "https://i.postimg.cc/JzXJjhjS/2malak-xi-14041106-113821537.jpg"},
            {name: "Alien", img: "https://i.postimg.cc/cJZKYBxH/lli-7-14041106-113832204.jpg"},
            {name: "Mira", img: "https://i.postimg.cc/44Mj38PZ/narilnn-14041106-114807454.jpg"},
            {name: "Fatima", img: "https://i.postimg.cc/K89HdJ1t/IMG-20260125-120922.jpg"},
            {name: "Aya", img: "https://i.postimg.cc/zXBFH5dn/ayosh-fa-16-14041106-114026409.jpg"},
            {name: "Alla", img: "https://i.postimg.cc/3NwmGCZR/lanax-97-14041106-113841657.jpg"}
        ]
    },
    {
        title: "Ø§Ù„ÙØ§Ù†Ø² Ø§Ù„Ù…ÙØ¶Ù„",
        cover: "https://i.postimg.cc/L53ScwYB/Picsart-26-01-25-14-06-23-331.png",
        candidates: [
            {name: "Aziz", img: "https://i.postimg.cc/J0XYfL96/narinvsn-14041106-111648574.jpg"},
            {name: "Fras", img: "https://i.postimg.cc/d1y9194Z/ghaith-fras-14041106-111624327.jpg"},
            {name: "Rami", img: "https://i.postimg.cc/7ZwtWjX7/talin-family3-14041106-111638529.jpg"},
            {name: "Mrs Avocado", img: "https://i.postimg.cc/65BkG7Rc/ghaithxsara-fans-14041106-104153672.jpg"},
            {name: "Osama", img: "https://i.postimg.cc/6pbVfPP4/mqnrt-14041106-111611071.jpg"},
            {name: "Mutasem", img: "https://i.postimg.cc/0ykZfD2S/ghaith-ediit-14041106-111631582.jpg"}
        ]
    }
];

let votedCategories = JSON.parse(localStorage.getItem('votedCategories')) || {};
let isVotingEnabled = true;

// Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØµÙˆÙŠØª Ù…Ù† Firebase
db.ref('settings/voting_enabled').on('value', (snapshot) => {
    isVotingEnabled = snapshot.val() !== false; // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© true
    updateVotingUI();
});

function updateVotingUI() {
    const btn = document.getElementById('toggle-voting-btn');
    const msg = document.getElementById('voting-status-msg');
    
    if (isVotingEnabled) {
        btn.innerText = "â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØµÙˆÙŠØª Ù…Ø¤Ù‚ØªØ§Ù‹";
        btn.className = "stop";
        msg.innerText = "";
    } else {
        btn.innerText = "â–¶ï¸ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ø¢Ù†";
        btn.className = "start";
        msg.innerText = "âš ï¸ Ø§Ù„ØªØµÙˆÙŠØª Ù…ØªÙˆÙ‚Ù Ø­Ø§Ù„ÙŠØ§Ù‹..";
    }

    // ØªØ¹Ø·ÙŠÙ„/ØªÙØ¹ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙˆÙŠØª ÙÙŠ Ø§Ù„ØµÙØ­Ø©
    const voteButtons = document.querySelectorAll('.candidate button');
    voteButtons.forEach(b => b.disabled = !isVotingEnabled);
}

function initGrid() {
    const grid = document.getElementById('main-grid');
    grid.innerHTML = '';
    categoriesData.forEach((cat, index) => {
        const isVoted = votedCategories[cat.title];
        const card = document.createElement('div');
        card.className = 'category-card';
        if(isVoted) card.style.opacity = "0.5";
        card.innerHTML = `<img src="${cat.cover}"><h3>${cat.title}</h3>`;
        card.onclick = () => openCategory(index);
        grid.appendChild(card);
    });
    updateProgressBar();
}

function openCategory(index) {
    if (votedCategories[categoriesData[index].title]) {
        let next = categoriesData.findIndex(c => !votedCategories[c.title]);
        if (next !== -1) openCategory(next);
        else showGrid();
        return;
    }
    document.getElementById('main-grid').style.display = 'none';
    document.getElementById('voting-area').style.display = 'block';
    const cat = categoriesData[index];
    document.getElementById('current-category-title').innerText = cat.title;
    const container = document.getElementById('candidates-container');
    container.innerHTML = '';
    cat.candidates.forEach(can => {
        const div = document.createElement('div');
        div.className = 'candidate';
        div.innerHTML = `
            <img src="${can.img}">
            <p>${can.name}</p>
            <button ${!isVotingEnabled ? 'disabled' : ''} onclick="vote('${cat.title}', '${can.name}', ${index})">Vote</button>
        `;
        container.appendChild(div);
    });
    window.scrollTo({top: 0, behavior: 'smooth'});
}

function vote(category, candidate, currentIndex) {
    if (!isVotingEnabled) {
        alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„ØªØµÙˆÙŠØª Ù…ØºÙ„Ù‚ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.");
        return;
    }

    const voteRef = db.ref('global_votes/' + category + '/' + candidate);
    voteRef.transaction((currentValue) => {
        return (currentValue || 0) + 1;
    });

    votedCategories[category] = true;
    localStorage.setItem('votedCategories', JSON.stringify(votedCategories));
    updateProgressBar();
    
    let nextIndex = currentIndex + 1;
    if (nextIndex < categoriesData.length) openCategory(nextIndex);
    else { alert("Thank you for voting!"); showGrid(); }
}

function updateProgressBar() {
    const percent = (Object.keys(votedCategories).length / categoriesData.length) * 100;
    document.getElementById("progress-bar").style.width = percent + "%";
}

function showGrid() {
    document.getElementById('main-grid').style.display = 'grid';
    document.getElementById('voting-area').style.display = 'none';
    initGrid();
}

function unlockAdmin() {
    if (prompt("Enter password:") === "fan_award") {
        document.getElementById('results-panel').style.display = 'block';
        db.ref('global_votes').on('value', (snapshot) => {
            renderResults(snapshot.val() || {});
        });
        window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'});
    } else {
        alert("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!");
    }
}

function toggleVoting() {
    db.ref('settings/voting_enabled').set(!isVotingEnabled);
}

function renderResults(data) {
    let html = "";
    categoriesData.forEach(cat => {
        let catVotes = data[cat.title] || {};
        let winner = { name: "Ù„Ø§ ÙŠÙˆØ¬Ø¯", count: -1 };
        let candidatesHtml = "";
        
        cat.candidates.forEach(can => {
            let count = catVotes[can.name] || 0;
            candidatesHtml += `<div class="candidate-score"><span>${can.name}</span> <b>${count} Ø£ØµÙˆØ§Øª</b></div>`;
            if (count > winner.count) winner = { name: can.name, count: count };
        });

        html += `
            <div class="category-result">
                <h3 style="color:var(--primary-gold)">â— ${cat.title}</h3>
                ${candidatesHtml}
                <span class="winner-tag">ğŸ† Ø§Ù„ÙØ§Ø¦Ø² Ø­Ø§Ù„ÙŠØ§Ù‹: ${winner.name}</span>
            </div>`;
    });
    document.getElementById('results-content').innerHTML = html;
}

function openResetModal() { document.getElementById('resetModal').style.display = 'flex'; }
function closeResetModal() { document.getElementById('resetModal').style.display = 'none'; }

function confirmReset() {
    db.ref('global_votes').remove().then(() => {
        localStorage.removeItem('votedCategories');
        closeResetModal();
        alert("ØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ø¨Ù†Ø¬Ø§Ø­.");
        location.reload();
    });
}

initGrid();
</script>
</body>
</html>pg"},
            {name: "Fatima", img: "https://i.postimg.cc/K89HdJ1t/IMG-20260125-120922.jpg"},
            {name: "Aya", img: "https://i.postimg.cc/zXBFH5dn/ayosh-fa-16-14041106-114026409.jpg"},
            {name: "Alla", img: "https://i.postimg.cc/3NwmGCZR/lanax-97-14041106-113841657.jpg"}
        ]
    },
    {
        title: "Ø§Ù„ÙØ§Ù†Ø² Ø§Ù„Ù…ÙØ¶Ù„",
        cover: "https://i.postimg.cc/L53ScwYB/Picsart-26-01-25-14-06-23-331.png",
        candidates: [
            {name: "Aziz", img: "https://i.postimg.cc/J0XYfL96/narinvsn-14041106-111648574.jpg"},
            {name: "Fras", img: "https://i.postimg.cc/d1y9194Z/ghaith-fras-14041106-111624327.jpg"},
            {name: "Rami", img: "https://i.postimg.cc/7ZwtWjX7/talin-family3-14041106-111638529.jpg"},
            {name: "Mrs Avocado", img: "https://i.postimg.cc/65BkG7Rc/ghaithxsara-fans-14041106-104153672.jpg"},
            {name: "Osama", img: "https://i.postimg.cc/6pbVfPP4/mqnrt-14041106-111611071.jpg"},
            {name: "Mutasem", img: "https://i.postimg.cc/0ykZfD2S/ghaith-ediit-14041106-111631582.jpg"}
        ]
    }
];

let votedCategories = JSON.parse(localStorage.getItem('votedCategories')) || {};
let isVotingEnabled = true;

// Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØµÙˆÙŠØª Ù…Ù† Firebase
db.ref('settings/voting_enabled').on('value', (snapshot) => {
    isVotingEnabled = snapshot.val() !== false; // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© true
    updateVotingUI();
});

function updateVotingUI() {
    const btn = document.getElementById('toggle-voting-btn');
    const msg = document.getElementById('voting-status-msg');
    
    if (isVotingEnabled) {
        btn.innerText = "â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØµÙˆÙŠØª Ù…Ø¤Ù‚ØªØ§Ù‹";
        btn.className = "stop";
        msg.innerText = "";
    } else {
        btn.innerText = "â–¶ï¸ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ø¢Ù†";
        btn.className = "start";
        msg.innerText = "âš ï¸ Ø§Ù„ØªØµÙˆÙŠØª Ù…ØªÙˆÙ‚Ù Ø­Ø§Ù„ÙŠØ§Ù‹..";
    }

    // ØªØ¹Ø·ÙŠÙ„/ØªÙØ¹ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙˆÙŠØª ÙÙŠ Ø§Ù„ØµÙØ­Ø©
    const voteButtons = document.querySelectorAll('.candidate button');
    voteButtons.forEach(b => b.disabled = !isVotingEnabled);
}

function initGrid() {
    const grid = document.getElementById('main-grid');
    grid.innerHTML = '';
    categoriesData.forEach((cat, index) => {
        const isVoted = votedCategories[cat.title];
        const card = document.createElement('div');
        card.className = 'category-card';
        if(isVoted) card.style.opacity = "0.5";
        card.innerHTML = `<img src="${cat.cover}"><h3>${cat.title}</h3>`;
        card.onclick = () => openCategory(index);
        grid.appendChild(card);
    });
    updateProgressBar();
}

function openCategory(index) {
    if (votedCategories[categoriesData[index].title]) {
        let next = categoriesData.findIndex(c => !votedCategories[c.title]);
        if (next !== -1) openCategory(next);
        else showGrid();
        return;
    }
    document.getElementById('main-grid').style.display = 'none';
    document.getElementById('voting-area').style.display = 'block';
    const cat = categoriesData[index];
    document.getElementById('current-category-title').innerText = cat.title;
    const container = document.getElementById('candidates-container');
    container.innerHTML = '';
    cat.candidates.forEach(can => {
        const div = document.createElement('div');
        div.className = 'candidate';
        div.innerHTML = `
            <img src="${can.img}">
            <p>${can.name}</p>
            <button ${!isVotingEnabled ? 'disabled' : ''} onclick="vote('${cat.title}', '${can.name}', ${index})">Vote</button>
        `;
        container.appendChild(div);
    });
    window.scrollTo({top: 0, behavior: 'smooth'});
}

function vote(category, candidate, currentIndex) {
    if (!isVotingEnabled) {
        alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„ØªØµÙˆÙŠØª Ù…ØºÙ„Ù‚ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.");
        return;
    }

    const voteRef = db.ref('global_votes/' + category + '/' + candidate);
    voteRef.transaction((currentValue) => {
        return (currentValue || 0) + 1;
    });

    votedCategories[category] = true;
    localStorage.setItem('votedCategories', JSON.stringify(votedCategories));
    updateProgressBar();
    
    let nextIndex = currentIndex + 1;
    if (nextIndex < categoriesData.length) openCategory(nextIndex);
    else { alert("Thank you for voting!"); showGrid(); }
}

function updateProgressBar() {
    const percent = (Object.keys(votedCategories).length / categoriesData.length) * 100;
    document.getElementById("progress-bar").style.width = percent + "%";
}

function showGrid() {
    document.getElementById('main-grid').style.display = 'grid';
    document.getElementById('voting-area').style.display = 'none';
    initGrid();
}

function unlockAdmin() {
    if (prompt("Enter password:") === "fan_award") {
        document.getElementById('results-panel').style.display = 'block';
        db.ref('global_votes').on('value', (snapshot) => {
            renderResults(snapshot.val() || {});
        });
        window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'});
    } else {
        alert("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!");
    }
}

function toggleVoting() {
    db.ref('settings/voting_enabled').set(!isVotingEnabled);
}

function renderResults(data) {
    let html = "";
    categoriesData.forEach(cat => {
        let catVotes = data[cat.title] || {};
        let winner = { name: "Ù„Ø§ ÙŠÙˆØ¬Ø¯", count: -1 };
        let candidatesHtml = "";
        
        cat.candidates.forEach(can => {
            let count = catVotes[can.name] || 0;
            candidatesHtml += `<div class="candidate-score"><span>${can.name}</span> <b>${count} Ø£ØµÙˆØ§Øª</b></div>`;
            if (count > winner.count) winner = { name: can.name, count: count };
        });

        html += `
            <div class="category-result">
                <h3 style="color:var(--primary-gold)">â— ${cat.title}</h3>
                ${candidatesHtml}
                <span class="winner-tag">ğŸ† Ø§Ù„ÙØ§Ø¦Ø² Ø­Ø§Ù„ÙŠØ§Ù‹: ${winner.name}</span>
            </div>`;
    });
    document.getElementById('results-content').innerHTML = html;
}

function openResetModal() { document.getElementById('resetModal').style.display = 'flex'; }
function closeResetModal() { document.getElementById('resetModal').style.display = 'none'; }

function confirmReset() {
    db.ref('global_votes').remove().then(() => {
        localStorage.removeItem('votedCategories');
        closeResetModal();
        alert("ØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ø¨Ù†Ø¬Ø§Ø­.");
        location.reload();
    });
}

initGrid();
</script>
</body>
</html>pg"},
            {name: "Fatima", img: "https://i.postimg.cc/K89HdJ1t/IMG-20260125-120922.jpg"},
            {name: "Aya", img: "https://i.postimg.cc/zXBFH5dn/ayosh-fa-16-14041106-114026409.jpg"},
            {name: "Alla", img: "https://i.postimg.cc/3NwmGCZR/lanax-97-14041106-113841657.jpg"}
        ]
    },
    {
        title: "Ø§Ù„ÙØ§Ù†Ø² Ø§Ù„Ù…ÙØ¶Ù„",
        cover: "https://i.postimg.cc/L53ScwYB/Picsart-26-01-25-14-06-23-331.png",
        candidates: [
            {name: "Aziz", img: "https://i.postimg.cc/J0XYfL96/narinvsn-14041106-111648574.jpg"},
            {name: "Fras", img: "https://i.postimg.cc/d1y9194Z/ghaith-fras-14041106-111624327.jpg"},
            {name: "Rami", img: "https://i.postimg.cc/7ZwtWjX7/talin-family3-14041106-111638529.jpg"},
            {name: "Mrs Avocado", img: "https://i.postimg.cc/65BkG7Rc/ghaithxsara-fans-14041106-104153672.jpg"},
            {name: "Osama", img: "https://i.postimg.cc/6pbVfPP4/mqnrt-14041106-111611071.jpg"},
            {name: "Mutasem", img: "https://i.postimg.cc/0ykZfD2S/ghaith-ediit-14041106-111631582.jpg"}
        ]
    }
];

let votedCategories = JSON.parse(localStorage.getItem('votedCategories')) || {};
let isVotingEnabled = true;

// Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØµÙˆÙŠØª Ù…Ù† Firebase
db.ref('settings/voting_enabled').on('value', (snapshot) => {
    isVotingEnabled = snapshot.val() !== false; // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© true
    updateVotingUI();
});

function updateVotingUI() {
    const btn = document.getElementById('toggle-voting-btn');
    const msg = document.getElementById('voting-status-msg');
    
    if (isVotingEnabled) {
        btn.innerText = "â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØµÙˆÙŠØª Ù…Ø¤Ù‚ØªØ§Ù‹";
        btn.className = "stop";
        msg.innerText = "";
    } else {
        btn.innerText = "â–¶ï¸ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ø¢Ù†";
        btn.className = "start";
        msg.innerText = "âš ï¸ Ø§Ù„ØªØµÙˆÙŠØª Ù…ØªÙˆÙ‚Ù Ø­Ø§Ù„ÙŠØ§Ù‹..";
    }

    // ØªØ¹Ø·ÙŠÙ„/ØªÙØ¹ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙˆÙŠØª ÙÙŠ Ø§Ù„ØµÙØ­Ø©
    const voteButtons = document.querySelectorAll('.candidate button');
    voteButtons.forEach(b => b.disabled = !isVotingEnabled);
}

function initGrid() {
    const grid = document.getElementById('main-grid');
    grid.innerHTML = '';
    categoriesData.forEach((cat, index) => {
        const isVoted = votedCategories[cat.title];
        const card = document.createElement('div');
        card.className = 'category-card';
        if(isVoted) card.style.opacity = "0.5";
        card.innerHTML = `<img src="${cat.cover}"><h3>${cat.title}</h3>`;
        card.onclick = () => openCategory(index);
        grid.appendChild(card);
    });
    updateProgressBar();
}

function openCategory(index) {
    if (votedCategories[categoriesData[index].title]) {
        let next = categoriesData.findIndex(c => !votedCategories[c.title]);
        if (next !== -1) openCategory(next);
        else showGrid();
        return;
    }
    document.getElementById('main-grid').style.display = 'none';
    document.getElementById('voting-area').style.display = 'block';
    const cat = categoriesData[index];
    document.getElementById('current-category-title').innerText = cat.title;
    const container = document.getElementById('candidates-container');
    container.innerHTML = '';
    cat.candidates.forEach(can => {
        const div = document.createElement('div');
        div.className = 'candidate';
        div.innerHTML = `
            <img src="${can.img}">
            <p>${can.name}</p>
            <button ${!isVotingEnabled ? 'disabled' : ''} onclick="vote('${cat.title}', '${can.name}', ${index})">Vote</button>
        `;
        container.appendChild(div);
    });
    window.scrollTo({top: 0, behavior: 'smooth'});
}

function vote(category, candidate, currentIndex) {
    if (!isVotingEnabled) {
        alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„ØªØµÙˆÙŠØª Ù…ØºÙ„Ù‚ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.");
        return;
    }

    const voteRef = db.ref('global_votes/' + category + '/' + candidate);
    voteRef.transaction((currentValue) => {
        return (currentValue || 0) + 1;
    });

    votedCategories[category] = true;
    localStorage.setItem('votedCategories', JSON.stringify(votedCategories));
    updateProgressBar();
    
    let nextIndex = currentIndex + 1;
    if (nextIndex < categoriesData.length) openCategory(nextIndex);
    else { alert("Thank you for voting!"); showGrid(); }
}

function updateProgressBar() {
    const percent = (Object.keys(votedCategories).length / categoriesData.length) * 100;
    document.getElementById("progress-bar").style.width = percent + "%";
}

function showGrid() {
    document.getElementById('main-grid').style.display = 'grid';
    document.getElementById('voting-area').style.display = 'none';
    initGrid();
}

function unlockAdmin() {
    if (prompt("Enter password:") === "fan_award") {
        document.getElementById('results-panel').style.display = 'block';
        db.ref('global_votes').on('value', (snapshot) => {
            renderResults(snapshot.val() || {});
        });
        window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'});
    } else {
        alert("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!");
    }
}

function toggleVoting() {
    db.ref('settings/voting_enabled').set(!isVotingEnabled);
}

function renderResults(data) {
    let html = "";
    categoriesData.forEach(cat => {
        let catVotes = data[cat.title] || {};
        let winner = { name: "Ù„Ø§ ÙŠÙˆØ¬Ø¯", count: -1 };
        let candidatesHtml = "";
        
        cat.candidates.forEach(can => {
            let count = catVotes[can.name] || 0;
            candidatesHtml += `<div class="candidate-score"><span>${can.name}</span> <b>${count} Ø£ØµÙˆØ§Øª</b></div>`;
            if (count > winner.count) winner = { name: can.name, count: count };
        });

        html += `
            <div class="category-result">
                <h3 style="color:var(--primary-gold)">â— ${cat.title}</h3>
                ${candidatesHtml}
                <span class="winner-tag">ğŸ† Ø§Ù„ÙØ§Ø¦Ø² Ø­Ø§Ù„ÙŠØ§Ù‹: ${winner.name}</span>
            </div>`;
    });
    document.getElementById('results-content').innerHTML = html;
}

function openResetModal() { document.getElementById('resetModal').style.display = 'flex'; }
function closeResetModal() { document.getElementById('resetModal').style.display = 'none'; }

function confirmReset() {
    db.ref('global_votes').remove().then(() => {
        localStorage.removeItem('votedCategories');
        closeResetModal();
        alert("ØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ø¨Ù†Ø¬Ø§Ø­.");
        location.reload();
    });
}

initGrid();
</script>
</body>
</html>postimg.cc/d1y9194Z/ghaith-fras-14041106-111624327.jpg"},
            {name: "Rami", img: "https://i.postimg.cc/7ZwtWjX7/talin-family3-14041106-111638529.jpg"},
            {name: "Mrs Avocado", img: "https://i.postimg.cc/65BkG7Rc/ghaithxsara-fans-14041106-104153672.jpg"},
            {name: "Osama", img: "https://i.postimg.cc/6pbVfPP4/mqnrt-14041106-111611071.jpg"},
            {name: "Mutasem", img: "https://i.postimg.cc/0ykZfD2S/ghaith-ediit-14041106-111631582.jpg"}
        ]
    }
];

let votedCategories = JSON.parse(localStorage.getItem('votedCategories')) || {};

function initGrid() {
    const grid = document.getElementById('main-grid');
    grid.innerHTML = '';
    categoriesData.forEach((cat, index) => {
        const isVoted = votedCategories[cat.title];
        const card = document.createElement('div');
        card.className = 'category-card';
        if(isVoted) card.style.opacity = "0.5";
        card.innerHTML = `<img src="${cat.cover}"><h3>${cat.title}</h3>`;
        card.onclick = () => openCategory(index);
        grid.appendChild(card);
    });
    updateProgressBar();
}

function openCategory(index) {
    if (votedCategories[categoriesData[index].title]) {
        let next = categoriesData.findIndex(c => !votedCategories[c.title]);
        if (next !== -1) openCategory(next);
        else showGrid();
        return;
    }
    document.getElementById('main-grid').style.display = 'none';
    document.getElementById('voting-area').style.display = 'block';
    const cat = categoriesData[index];
    document.getElementById('current-category-title').innerText = cat.title;
    const container = document.getElementById('candidates-container');
    container.innerHTML = '';
    cat.candidates.forEach(can => {
        const div = document.createElement('div');
        div.className = 'candidate';
        div.innerHTML = `<img src="${can.img}"><p>${can.name}</p><button onclick="vote('${cat.title}', '${can.name}', ${index})">Vote</button>`;
        container.appendChild(div);
    });
    window.scrollTo({top: 0, behavior: 'smooth'});
}

function vote(category, candidate, currentIndex) {
    const voteRef = db.ref('global_votes/' + category + '/' + candidate);
    voteRef.transaction((currentValue) => {
        return (currentValue || 0) + 1;
    });

    votedCategories[category] = true;
    localStorage.setItem('votedCategories', JSON.stringify(votedCategories));
    updateProgressBar();
    
    let nextIndex = currentIndex + 1;
    if (nextIndex < categoriesData.length) openCategory(nextIndex);
    else { alert("Thank you for voting!"); showGrid(); }
}

function updateProgressBar() {
    const percent = (Object.keys(votedCategories).length / categoriesData.length) * 100;
    document.getElementById("progress-bar").style.width = percent + "%";
}

function showGrid() {
    document.getElementById('main-grid').style.display = 'grid';
    document.getElementById('voting-area').style.display = 'none';
    initGrid();
}

function unlockAdmin() {
    if (prompt("Enter password:") === "fan_award") {
        document.getElementById('results-panel').style.display = 'block';
        db.ref('global_votes').on('value', (snapshot) => {
            renderResults(snapshot.val() || {});
        });
        window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'});
    } else {
        alert("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!");
    }
}

function renderResults(data) {
    let html = "";
    categoriesData.forEach(cat => {
        let catVotes = data[cat.title] || {};
        let winner = { name: "Ù„Ø§ ÙŠÙˆØ¬Ø¯", count: -1 };
        let candidatesHtml = "";
        
        cat.candidates.forEach(can => {
            let count = catVotes[can.name] || 0;
            candidatesHtml += `<div class="candidate-score"><span>${can.name}</span> <b>${count} Ø£ØµÙˆØ§Øª</b></div>`;
            if (count > winner.count) winner = { name: can.name, count: count };
        });

        html += `
            <div class="category-result">
                <h3 style="color:var(--primary-gold)">â— ${cat.title}</h3>
                ${candidatesHtml}
                <span class="winner-tag">ğŸ† Ø§Ù„ÙØ§Ø¦Ø² Ø­Ø§Ù„ÙŠØ§Ù‹: ${winner.name}</span>
            </div>`;
    });
    document.getElementById('results-content').innerHTML = html;
}

function openResetModal() { document.getElementById('resetModal').style.display = 'flex'; }
function closeResetModal() { document.getElementById('resetModal').style.display = 'none'; }

function confirmReset() {
    db.ref('global_votes').remove().then(() => {
        localStorage.removeItem('votedCategories');
        closeResetModal();
        alert("ØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ø¨Ù†Ø¬Ø§Ø­.");
        location.reload();
    });
}

initGrid();
</script>
</body>

</html>





<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fan Award</title>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<style>
    :root {
        --primary-gold: #d4af37;
        --bg-dark: #0f0f0f;
        --panel-gray: #222222; 
        --card-bg: rgba(255, 255, 255, 0.05);
        --status-stop: #e67e22;
        --status-start: #27ae60;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: radial-gradient(circle at top, #1a1a1a 0%, #000 100%);
        color: #fff;
        margin: 0;
        padding: 15px;
        min-height: 100vh;
    }

    .container { max-width: 800px; margin: auto; }

    .categories-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .category-card:last-child:nth-child(odd) { grid-column: span 2; width: 60%; justify-self: center; }

    .category-card {
        background: var(--card-bg);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 15px;
        padding: 10px;
        cursor: pointer;
        text-align: center;
    }
    .category-card img { width: 100%; height: 140px; object-fit: cover; border-radius: 10px; }

    .voting-area {
        display: none;
        background-color: var(--panel-gray);
        border: 2px solid #333;
        border-radius: 25px;
        padding: 25px;
        margin-top: 20px;
        box-shadow: 0 15px 40px rgba(0,0,0,0.6);
    }

    .candidates-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 20px; }

    .candidate { 
        background: rgba(255, 255, 255, 0.05);
        padding: 15px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1);
        text-align: center;
    }

    .candidate img { width: 85px; height: 85px; border-radius: 50%; border: 2px solid var(--primary-gold); object-fit: cover; margin-bottom: 10px; }

    #progress-container { width: 100%; background: #333; border-radius: 10px; margin: 20px 0; height: 8px; }
    #progress-bar { width: 0%; height: 100%; background: var(--primary-gold); transition: width 0.5s ease; }

    button { background: var(--primary-gold); color: #000; border: none; padding: 10px; border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s; }
    button:disabled { background: #555 !important; cursor: not-allowed; opacity: 0.6; }
    
    .back-btn { background: #444; color: #fff; width: auto; padding: 8px 15px; margin-bottom: 15px; }
    
    .results-panel {
        display: none;
        background: #111;
        border: 1px solid var(--primary-gold);
        border-radius: 20px;
        padding: 25px;
        margin-top: 30px;
    }
    .category-result { border-bottom: 1px solid #333; padding: 15px 0; }
    .candidate-score { display: flex; justify-content: space-between; background: rgba(255,255,255,0.03); margin: 5px 0; padding: 8px 15px; border-radius: 5px; font-size: 0.9rem; }
    .winner-tag { color: #0f0; font-weight: bold; margin-top: 10px; display: block; background: rgba(0,255,0,0.1); padding: 5px; border-radius: 5px; text-align: center; }
    
    .admin-controls { display: flex; gap: 10px; flex-direction: column; margin-top: 20px; }
    .reset-danger-btn { background: #900; color: white; border: 1px solid #f00; }
    #toggle-voting-btn.stop { background: var(--status-stop); color: white; }
    #toggle-voting-btn.start { background: var(--status-start); color: white; }

    .modal-overlay {
        display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.85); z-index: 2000; align-items: center; justify-content: center;
    }
    .modal-box {
        background: #222; border: 2px solid var(--primary-gold); padding: 30px;
        border-radius: 20px; width: 90%; max-width: 400px; text-align: center;
    }
    .modal-buttons { display: flex; gap: 10px; margin-top: 20px; }
    .btn-yes { background: #d9534f; color: white; }
    .btn-cancel { background: #5bc0de; color: white; }

    h1 { background: linear-gradient(to bottom, #fff, var(--primary-gold)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; }
</style>
</head>

<body>
<div class="container">
    <h1>Fan Award</h1>
    <p style="text-align: center;">!Welcome to fan award</p>
    <p id="voting-status-msg" style="text-align: center; color: var(--primary-gold); font-weight: bold;"></p>
    
    <div id="progress-container"><div id="progress-bar"></div></div>

    <div id="main-grid" class="categories-grid"></div>

    <div id="voting-area" class="voting-area">
        <button class="back-btn" onclick="showGrid()">â† Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
        <h2 id="current-category-title" style="text-align: center; color: var(--primary-gold);"></h2>
        <div id="candidates-container" class="candidates-grid"></div>
    </div>

    <div style="text-align: center; margin-top: 40px;">
        <button id="admin-access-btn" style="background:none; color:#444; border:1px solid #222; width:auto; font-size: 0.8rem;" onclick="unlockAdmin()">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØµÙˆÙŠØªØ§Øª</button>
    </div>

    <div id="results-panel" class="results-panel">
        <h2 style="text-align: center; color: var(--primary-gold);">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h2>
        <div id="results-content"></div>
        
        <div class="admin-controls">
            <button id="toggle-voting-btn" onclick="toggleVoting()"></button>
            <button class="reset-danger-btn" onclick="openResetModal()">âš ï¸ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§ÙØ© Ø§Ù„ØªØµÙˆÙŠØªØ§Øª</button>
        </div>
    </div>
</div>

<div id="resetModal" class="modal-overlay">
    <div class="modal-box">
        <h3 style="color: #fff;">ØªØ­Ø°ÙŠØ±!</h3>
        <p>Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒØ§ÙØ© Ø§Ù„ØªØµÙˆÙŠØªØ§ØªØŸ</p>
        <div class="modal-buttons">
            <button class="btn-yes" onclick="confirmReset()">Yes</button>
            <button class="btn-cancel" onclick="closeResetModal()">Cancel</button>
        </div>
    </div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAG2A7nWx-Mnq3aB8182945PAM6iZxRiFk",
  authDomain: "fan-award.firebaseapp.com",
  databaseURL: "https://fan-award-99805-default-rtdb.firebaseio.com/",
  projectId: "fan-award",
  storageBucket: "fan-award.firebasestorage.app",
  messagingSenderId: "575009416899",
  appId: "1:575009416899:web:6fcdd03f30d11896046476",
  measurementId: "G-0LMWPN63X7"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const categoriesData = [
    {
        title: "ÙƒØ¨Ø§Ø± Ø§Ù„ÙØ§Ù†Ø²",
        cover: "https://i.postimg.cc/XvsVJTsb/Picsart-26-01-25-14-07-23-728.png",
        candidates: [
            {name: "Mrs Avocado", img: "https://i.postimg.cc/65BkG7Rc/ghaithxsara-fans-14041106-104153672.jpg"},
            {name: "Abrar", img: "https://i.postimg.cc/dtmJbPRd/aaaxx-1-14041106-104329227.jpg"},
            {name: "Tween", img: "https://i.postimg.cc/GpnJHDTw/tween-b2-14041106-104221136.jpg"},
            {name: "Yana", img: "https://i.postimg.cc/rss5vC3m/lancrv-14041106-104204630.jpg"},
            {name: "Malak", img: "https://i.postimg.cc/YqJQsF32/iconic-malak-14041106-104237528.jpg"},
            {name: "Raghad", img: "https://i.postimg.cc/s2z7VRbQ/raghad-b1-14041106-104249920.jpg"}
        ]
    },
    {
        title: "Ø§Ù„Ù…ØµÙ…Ù… Ø§Ù„Ù…ÙØ¶Ù„",
        cover: "https://i.postimg.cc/pTgyWwdy/Picsart-26-01-25-14-12-22-577.png",
        candidates: [
            {name: "Aziz", img: "https://i.postimg.cc/J0XYfL96/narinvsn-14041106-111648574.jpg"},
            {name: "Fras", img: "https://i.postimg.cc/d1y9194Z/ghaith-fras-14041106-111624327.jpg"},
            {name: "Rami", img: "https://i.postimg.cc/7ZwtWjX7/talin-family3-14041106-111638529.jpg"},
            {name: "Munzar", img: "https://i.postimg.cc/HLSN53wy/fan-fouad-1-14041106-111658002.jpg"},
            {name: "Osama", img: "https://i.postimg.cc/6pbVfPP4/mqnrt-14041106-111611071.jpg"},
            {name: "Mutasem", img: "https://i.postimg.cc/0ykZfD2S/ghaith-ediit-14041106-111631582.jpg"}
        ]
    },
    {
        title: "Ø§Ù„Ù…ØµÙ…Ù…Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø©",
        cover: "https://i.postimg.cc/QN1dgntH/Picsart-26-01-25-14-13-54-206.png",
        candidates: [
            {name: "Hajar", img: "https://i.postimg.cc/C1cwRj1G/janaqueen-hajar-14041106-112411741.jpg"},
            {name: "Reem", img: "https://i.postimg.cc/bvHyhXfm/reem-km3-14041106-112438826.jpg"},
            {name: "Maisam", img: "https://i.postimg.cc/VLpL9BFD/lanax9-14041106-112455102.jpg"},
            {name: "Hala", img: "https://i.postimg.cc/pLKxfNrj/7ala10-1-14041106-112425720.jpg"},
            {name: "Yara", img: "https://i.postimg.cc/d3WDcbrC/IMG-20260125-112541.jpg"},
            {name: "Fatima", img: "https://i.postimg.cc/sXs2QjJp/ghaith-fatima13-14041106-112526414.jpg"}
        ]
    },
    {
        title: "Ø§Ù„ÙØ§Ù†Ø² Ø§Ù„Ù…ÙØ¶Ù„Ø©",
        cover: "https://i.postimg.cc/N0H3hSZ2/Picsart-26-01-25-14-16-39-061.png",
        candidates: [
            {name: "Abrar", img: "https://i.postimg.cc/FKCXVhy2/a9-ux-14041106-113727398.jpg"},
            {name: "Amira", img: "https://i.postimg.cc/c188pHby/nariuiiiiil-14041106-113651707.jpg"},
            {name: "Tebo", img: "https://i.postimg.cc/Qdq7fynX/tebo-ghaith77-14041106-113703589.jpg"},
            {name: "Rayan", img: "https://i.postimg.cc/0jLjNpX9/just-rayan27-14041106-113713738.jpg"},
            {name: "Lina", img: "https://i.postimg.cc/Qd6t9GyB/lina-x-42-14041106-113641698.jpg"},
            {name: "Nour", img: "https://i.postimg.cc/wvrTWXpt/1nxlla-14041106-113737667.jpg"},
            {name: "Malak", img: "https://i.postimg.cc/JzXJjhjS/2malak-xi-14041106-113821537.jpg"},
            {name: "Alien", img: "https://i.postimg.cc/cJZKYBxH/lli-7-14041106-113832204.jpg"},
            {name: "Mira", img: "https://i.postimg.cc/44Mj38PZ/narilnn-14041106-114807454.jpg"},
            {name: "Fatima", img: "https://i.postimg.cc/K89HdJ1t/IMG-20260125-120922.jpg"},
            {name: "Aya", img: "https://i.postimg.cc/zXBFH5dn/ayosh-fa-16-14041106-114026409.jpg"},
            {name: "Alla", img: "https://i.postimg.cc/3NwmGCZR/lanax-97-14041106-113841657.jpg"}
        ]
    },
    {
        title: "Ø§Ù„ÙØ§Ù†Ø² Ø§Ù„Ù…ÙØ¶Ù„",
        cover: "https://i.postimg.cc/L53ScwYB/Picsart-26-01-25-14-06-23-331.png",
        candidates: [
            {name: "Aziz", img: "https://i.postimg.cc/J0XYfL96/narinvsn-14041106-111648574.jpg"},
            {name: "Fras", img: "https://i.postimg.cc/d1y9194Z/ghaith-fras-14041106-111624327.jpg"},
            {name: "Rami", img: "https://i.postimg.cc/7ZwtWjX7/talin-family3-14041106-111638529.jpg"},
            {name: "Mrs Avocado", img: "https://i.postimg.cc/65BkG7Rc/ghaithxsara-fans-14041106-104153672.jpg"},
            {name: "Osama", img: "https://i.postimg.cc/6pbVfPP4/mqnrt-14041106-111611071.jpg"},
            {name: "Mutasem", img: "https://i.postimg.cc/0ykZfD2S/ghaith-ediit-14041106-111631582.jpg"}
        ]
    }
];

let votedCategories = JSON.parse(localStorage.getItem('votedCategories')) || {};
let isVotingEnabled = true;

// Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØµÙˆÙŠØª Ù…Ù† Firebase
db.ref('settings/voting_enabled').on('value', (snapshot) => {
    isVotingEnabled = snapshot.val() !== false; // Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© true
    updateVotingUI();
});

function updateVotingUI() {
    const btn = document.getElementById('toggle-voting-btn');
    const msg = document.getElementById('voting-status-msg');
    
    if (isVotingEnabled) {
        btn.innerText = "â¸ï¸ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØµÙˆÙŠØª Ù…Ø¤Ù‚ØªØ§Ù‹";
        btn.className = "stop";
        msg.innerText = "";
    } else {
        btn.innerText = "â–¶ï¸ ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØµÙˆÙŠØª Ø§Ù„Ø¢Ù†";
        btn.className = "start";
        msg.innerText = "âš ï¸ Ø§Ù„ØªØµÙˆÙŠØª Ù…ØªÙˆÙ‚Ù Ø­Ø§Ù„ÙŠØ§Ù‹..";
    }

    // ØªØ¹Ø·ÙŠÙ„/ØªÙØ¹ÙŠÙ„ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØµÙˆÙŠØª ÙÙŠ Ø§Ù„ØµÙØ­Ø©
    const voteButtons = document.querySelectorAll('.candidate button');
    voteButtons.forEach(b => b.disabled = !isVotingEnabled);
}

function initGrid() {
    const grid = document.getElementById('main-grid');
    grid.innerHTML = '';
    categoriesData.forEach((cat, index) => {
        const isVoted = votedCategories[cat.title];
        const card = document.createElement('div');
        card.className = 'category-card';
        if(isVoted) card.style.opacity = "0.5";
        card.innerHTML = `<img src="${cat.cover}"><h3>${cat.title}</h3>`;
        card.onclick = () => openCategory(index);
        grid.appendChild(card);
    });
    updateProgressBar();
}

function openCategory(index) {
    if (votedCategories[categoriesData[index].title]) {
        let next = categoriesData.findIndex(c => !votedCategories[c.title]);
        if (next !== -1) openCategory(next);
        else showGrid();
        return;
    }
    document.getElementById('main-grid').style.display = 'none';
    document.getElementById('voting-area').style.display = 'block';
    const cat = categoriesData[index];
    document.getElementById('current-category-title').innerText = cat.title;
    const container = document.getElementById('candidates-container');
    container.innerHTML = '';
    cat.candidates.forEach(can => {
        const div = document.createElement('div');
        div.className = 'candidate';
        div.innerHTML = `
            <img src="${can.img}">
            <p>${can.name}</p>
            <button ${!isVotingEnabled ? 'disabled' : ''} onclick="vote('${cat.title}', '${can.name}', ${index})">Vote</button>
        `;
        container.appendChild(div);
    });
    window.scrollTo({top: 0, behavior: 'smooth'});
}

function vote(category, candidate, currentIndex) {
    if (!isVotingEnabled) {
        alert("Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø§Ù„ØªØµÙˆÙŠØª Ù…ØºÙ„Ù‚ Ø­Ø§Ù„ÙŠØ§Ù‹ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.");
        return;
    }

    const voteRef = db.ref('global_votes/' + category + '/' + candidate);
    voteRef.transaction((currentValue) => {
        return (currentValue || 0) + 1;
    });

    votedCategories[category] = true;
    localStorage.setItem('votedCategories', JSON.stringify(votedCategories));
    updateProgressBar();
    
    let nextIndex = currentIndex + 1;
    if (nextIndex < categoriesData.length) openCategory(nextIndex);
    else { alert("Thank you for voting!"); showGrid(); }
}

function updateProgressBar() {
    const percent = (Object.keys(votedCategories).length / categoriesData.length) * 100;
    document.getElementById("progress-bar").style.width = percent + "%";
}

function showGrid() {
    document.getElementById('main-grid').style.display = 'grid';
    document.getElementById('voting-area').style.display = 'none';
    initGrid();
}

function unlockAdmin() {
    if (prompt("Enter password:") === "fan_award") {
        document.getElementById('results-panel').style.display = 'block';
        db.ref('global_votes').on('value', (snapshot) => {
            renderResults(snapshot.val() || {});
        });
        window.scrollTo({top: document.body.scrollHeight, behavior: 'smooth'});
    } else {
        alert("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!");
    }
}

function toggleVoting() {
    db.ref('settings/voting_enabled').set(!isVotingEnabled);
}

function renderResults(data) {
    let html = "";
    categoriesData.forEach(cat => {
        let catVotes = data[cat.title] || {};
        let winner = { name: "Ù„Ø§ ÙŠÙˆØ¬Ø¯", count: -1 };
        let candidatesHtml = "";
        
        cat.candidates.forEach(can => {
            let count = catVotes[can.name] || 0;
            candidatesHtml += `<div class="candidate-score"><span>${can.name}</span> <b>${count} Ø£ØµÙˆØ§Øª</b></div>`;
            if (count > winner.count) winner = { name: can.name, count: count };
        });

        html += `
            <div class="category-result">
                <h3 style="color:var(--primary-gold)">â— ${cat.title}</h3>
                ${candidatesHtml}
                <span class="winner-tag">ğŸ† Ø§Ù„ÙØ§Ø¦Ø² Ø­Ø§Ù„ÙŠØ§Ù‹: ${winner.name}</span>
            </div>`;
    });
    document.getElementById('results-content').innerHTML = html;
}

function openResetModal() { document.getElementById('resetModal').style.display = 'flex'; }
function closeResetModal() { document.getElementById('resetModal').style.display = 'none'; }

function confirmReset() {
    db.ref('global_votes').remove().then(() => {
        localStorage.removeItem('votedCategories');
        closeResetModal();
        alert("ØªÙ… ØªØµÙÙŠØ± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¹Ø§Ù„Ù…ÙŠØ§Ù‹ Ø¨Ù†Ø¬Ø§Ø­.");
        location.reload();
    });
}

initGrid();
</script>
</body>
        </html>

